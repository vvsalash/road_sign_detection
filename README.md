# road_sign_detection

## Процесс обработки данных для BDD100K

### Шаги:

1. **Скачать датасет**
    - Скачайте датасет BDD100K с Kaggle по следующей ссылке: [BDD100K Dataset](https://www.kaggle.com/datasets/solesensei/solesensei_bdd100k).
  
2. **Переместить изображения в отдельные директории**
    - Для упорядочивания изображений, переместите их из исходной директории `bdd100k/images` в соответствующие директории: `bdd100k/dataset/train`, `bdd100k/dataset/val` и `bdd100k/dataset/test`. Используйте следующие команды для перемещения изображений:

    ```bash
    find путь_откуда -maxdepth 1 -type f -name "*.jpg" | xargs -I {} mv {} путь_куда
    ```

    Это перенесет все изображения в соответствующие директории.

3. **Запустить скрипт для создания разметки и нормализации датасета**
    - После того как изображения будут перемещены, запустите скрипт `detection_data_parser.py`, который обрабатывает аннотации и нормализует количество изображений с дорожными знаками (traffic signs) и без.
   Скрипт:
      - Загружает аннотации из JSON файлов
      - Создает текстовые файлы с разметкой для изображений с дорожными знаками
      - Удаляет изображения без разметки и, чтобы сбалансировать датасет, оставляет 50% изображений с дорожными знаками и 50% без них

    Скрипт автоматически создаст соответствующие текстовые файлы с разметкой для каждого изображения в директориях `bdd100k/labels/train` и `bdd100k/labels/val` в формате YOLOv8

4. **Результат**
    - В результате, после выполнения всех шагов, у вас будет готовый датасет, разделенный на тренировочную, валидационную и тестовую части, с аннотированными изображениями и сбалансированным количеством изображений с и без дорожных знаков.
